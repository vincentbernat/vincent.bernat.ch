---
title: "Netops avec Emacs et Org mode"
description: |
  Planifier et exécuter des opérations réseau sur du matériel Juniper
  directement depuis Emacs avec Org mode.
keywords: "netops, emacs, org mode, juniper, junos, async, babel"
uuid: eb85958d-d56c-4a1f-a334-0f84d59aa9be
tags:
  - network
---

[Org mode][] est un paquet pour Emacs permettant de « prendre des
notes, maintenir une liste des tâches, planifier des projets et écrire
des documents ». Il peut exécuter des extraits de code et en capturer
la sortie (via [Babel][]). C'est un outil inestimable
pour [documenter son infrastructure et ses opérations][devops].

Voici trois (relativement) courtes vidéos démontrant l'utilisation de
*Org mode* dans le cadre des **opérations réseau** sur du matériel
*Juniper*. J'y utilise [junos-mode][] qui propose les fonctionnalités
suivantes :

 - **coloration syntaxique** pour les fichiers de configuration ;
 - application de **fragments de configuration** sur des équipements distants ;
 - exécution de **commandes arbitraires**.

Certains équipements Junos peuvent être particulièrement
lents. Aussi, l'application de configuration et l'éxecution de
commandes se fait de manière asynchrone[^async] à l'aide d'un
programme compagnon en Python.

[^async]: Il s'agit principalement d'une bidouille car *Babel* ne
    propose rien en natif à cet effet. Le paquet [ob-async][] propose
    une généralisation de ce concept à n'importe quel langage
    supporté.

Dans la première vidéo, je prends des **notes** sur la configuration
de BGP *add-path* ([RFC 7911][]). La plupart des fonctionnalités
de [junos-mode][] y sont présentées.

![](youtube:e9sjhbxWJNE)

Dans la seconde vidéo, j'exécute une **opération planifiée** pour
activer cette fonctionnalité en production. Le document est un mode
opératoire et contient la configuration à appliquer ainsi que les
commandes à utiliser pour vérifier le bon fonctionnement. À la fin, on
obtient un compte-rendu détaillé de l'opération.

![](youtube:jCH-gO7RfFE)

Dans la troisième vidéo, une **recette** a été utilisée pour exécuter
un changement. Je fournis quelques variables en entrée, j'exécute la
recette puis je vérifie le résultat.

![](youtube:L0G72g7R-xY)

*[Junos]: Juniper Network Operating System
*[BGP]: Border Gateway Protocol

[Org mode]: http://orgmode.org/ "Org mode for Emacs - Your Life in Plain Text"
[devops]: http://www.howardism.org/Technical/Emacs/literate-devops.html "Literate DevOps"
[junos-mode]: https://github.com/vincentbernat/junos-mode "Mode majeur Emacs pour les fichiers de configuration Junos"
[Babel]: http://orgmode.org/worg/org-contrib/babel/ "Babel: active code in Org-mode"
[ob-async]: https://github.com/astahlman/ob-async "ob-async: asynchronous src_block execution for org-babel"
[RFC 7911]: https://tools.ietf.org/html/rfc7911 "Advertisement of Multiple Paths in BGP"

{# Local Variables:      #}
{# mode: markdown        #}
{# indent-tabs-mode: nil #}
{# End:                  #}
